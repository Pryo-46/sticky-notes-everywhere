# å®Ÿè£…è¨ˆç”»æ›¸ï¼šWebä»˜ç®‹æ‹¡å¼µæ©Ÿèƒ½

## 1. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| é …ç›® | æŠ€è¡“ |
|------|------|
| ç¨®åˆ¥ | Chromeæ‹¡å¼µæ©Ÿèƒ½ï¼ˆManifest V3ï¼‰ |
| è¨€èª | TypeScript |
| UI | Vanilla DOMæ“ä½œï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã—ï¼‰ |
| ãƒ“ãƒ«ãƒ‰ | Vite ã¾ãŸã¯ esbuild |
| ã‚¹ã‚¿ã‚¤ãƒ« | CSSï¼ˆShadow DOMå†…ã«é–‰ã˜è¾¼ã‚ï¼‰ |

â€»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã‚ãªã„ç†ç”±ï¼šContent Scriptã¨ã—ã¦è»½é‡ã«å‹•ä½œã•ã›ã‚‹ãŸã‚

---

## 2. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
sticky-note-extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ manifest.json          # æ‹¡å¼µæ©Ÿèƒ½ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ background.ts          # Service Workerï¼ˆã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ï¼‰
â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”œâ”€â”€ index.ts           # Content Script ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ MenuBar.ts         # ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UI
â”‚   â”‚   â”œâ”€â”€ StickyNote.ts      # ä»˜ç®‹ã‚¯ãƒ©ã‚¹
â”‚   â”‚   â”œâ”€â”€ StickyManager.ts   # ä»˜ç®‹ã®ç®¡ç†ï¼ˆCRUDã€è¡¨ç¤ºçŠ¶æ…‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ DragCreateHandler.ts # ãƒ‰ãƒ©ãƒƒã‚°ã§ä»˜ç®‹ä½œæˆ
â”‚   â”‚   â”œâ”€â”€ DragMoveHandler.ts # ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•å‡¦ç†
â”‚   â”‚   â”œâ”€â”€ ResizeHandler.ts   # ãƒªã‚µã‚¤ã‚ºå‡¦ç†
â”‚   â”‚   â”œâ”€â”€ ExportHandler.ts   # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†
â”‚   â”‚   â””â”€â”€ styles.css         # ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts           # å‹å®šç¾©
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icons/                 # æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ vite.config.ts
```

---

## 3. å‹å®šç¾©

```typescript
// types/index.ts

/** ä»˜ç®‹ã®è‰² */
type StickyColor = 'red' | 'orange' | 'yellow' | 'green' | 'cyan' | 'gray' | 'white';

/** ä»˜ç®‹ã®ã‚µã‚¤ã‚ºãƒ—ãƒªã‚»ãƒƒãƒˆ */
type StickySize = 'small' | 'medium' | 'large';

/** ä»˜ç®‹ã®ã‚µã‚¤ã‚ºï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰ */
interface StickyDimensions {
  width: number;
  height: number;
}

/** ã‚µã‚¤ã‚ºãƒ—ãƒªã‚»ãƒƒãƒˆã®å®šç¾© */
const SIZE_PRESETS: Record<StickySize, StickyDimensions> = {
  small: { width: 150, height: 100 },
  medium: { width: 200, height: 150 },
  large: { width: 300, height: 200 },
};

/** ä»˜ç®‹ãƒ‡ãƒ¼ã‚¿ */
interface StickyNoteData {
  id: string;
  text: string;
  color: StickyColor;
  position: { x: number; y: number };
  size: StickyDimensions;
  createdAt: number;
}
```

---

## 4. ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥å®Ÿè£…è¨ˆç”»

### Phase 1: åŸºç›¤æ§‹ç¯‰
**ç›®æ¨™ï¼šæ‹¡å¼µæ©Ÿèƒ½ã¨ã—ã¦å‹•ä½œã™ã‚‹æœ€å°æ§‹æˆ**

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆVite + TypeScriptï¼‰
- [ ] manifest.jsonä½œæˆï¼ˆManifest V3ï¼‰
- [ ] background.tsï¼ˆService Workerï¼‰ã§ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥
- [ ] Content Scriptã®åŸºæœ¬æ§‹æˆ
- [ ] ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼è¡¨ç¤º/éè¡¨ç¤º

**å®Œäº†æ¡ä»¶ï¼šæ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãŒè¡¨ç¤º/éè¡¨ç¤ºã•ã‚Œã‚‹**

---

### Phase 2: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UI
**ç›®æ¨™ï¼šãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã®è¦‹ãŸç›®ã¨åŸºæœ¬å‹•ä½œ**

- [ ] MenuBarã‚¯ãƒ©ã‚¹å®Ÿè£…
  - ç”»é¢ä¸Šéƒ¨ã«å›ºå®šè¡¨ç¤º
  - ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆ7è‰²ï¼‰
  - ã‚µã‚¤ã‚ºãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆS/M/Lï¼‰
  - å„ç¨®ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç›®ãƒ»ã‚´ãƒŸç®±ãƒ»ã‚³ãƒ”ãƒ¼ãƒ»Ã—ï¼‰
- [ ] ã‚µã‚¤ã‚ºé¸æŠçŠ¶æ…‹ã®ç®¡ç†
- [ ] Ã—ãƒœã‚¿ãƒ³ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚’é–‰ã˜ã‚‹

**å®Œäº†æ¡ä»¶ï¼šãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã€ã‚µã‚¤ã‚ºé¸æŠãŒã§ãã‚‹**

---

### Phase 3: ãƒ‰ãƒ©ãƒƒã‚°ã§ä»˜ç®‹ä½œæˆ
**ç›®æ¨™ï¼šã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰ãƒ‰ãƒ©ãƒƒã‚°ã§ä»˜ç®‹ã‚’ä½œæˆ**

- [ ] DragCreateHandlerå®Ÿè£…
  - ã‚«ãƒ©ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®dragstart
  - ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  - ãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®ã«ä»˜ç®‹ã‚’ç”Ÿæˆ
- [ ] StickyNoteã‚¯ãƒ©ã‚¹å®Ÿè£…
  - ä»˜ç®‹DOMè¦ç´ ã®ç”Ÿæˆ
  - ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ï¼ˆç§»å‹•ç”¨ã€ç§»å‹•ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºï¼‰
  - ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ï¼ˆå…¥åŠ›ãƒ»ç·¨é›†ãƒ»é¸æŠï¼‰
  - å€‹åˆ¥å‰Šé™¤ãƒœã‚¿ãƒ³
- [ ] StickyManagerå®Ÿè£…
  - ä»˜ç®‹ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸€è¦§ç®¡ç†

**å®Œäº†æ¡ä»¶ï¼šè‰²ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä»˜ç®‹ãŒä½œæˆã•ã‚Œã‚‹**

---

### Phase 4: ä»˜ç®‹ã®ç§»å‹•
**ç›®æ¨™ï¼šä»˜ç®‹ã‚’è‡ªç”±ã«ç§»å‹•ã§ãã‚‹**

- [ ] DragMoveHandlerå®Ÿè£…
  - mousedown/mousemove/mouseup ã‚¤ãƒ™ãƒ³ãƒˆ
  - position: fixed ã§ã®åº§æ¨™æ›´æ–°
- [ ] ç”»é¢ç«¯ã§ã®åˆ¶é™ï¼ˆç”»é¢å¤–ã«å‡ºãªã„ã‚ˆã†ã«ï¼‰
- [ ] z-indexç®¡ç†ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§æœ€å‰é¢ã¸ï¼‰

**å®Œäº†æ¡ä»¶ï¼šä»˜ç®‹ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ç”»é¢å†…ã®ä»»æ„ã®ä½ç½®ã«ç§»å‹•ã§ãã‚‹**

---

### Phase 5: ãƒªã‚µã‚¤ã‚º
**ç›®æ¨™ï¼šä»˜ç®‹ã®ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã§ãã‚‹**

- [ ] ResizeHandlerå®Ÿè£…
  - å³ä¸‹è§’ã«ãƒªã‚µã‚¤ã‚ºãƒãƒ³ãƒ‰ãƒ«ï¼ˆãƒªã‚µã‚¤ã‚ºã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºï¼‰
  - ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚µã‚¤ã‚ºå¤‰æ›´
- [ ] æœ€å°ã‚µã‚¤ã‚ºã®åˆ¶é™
- [ ] ä½œæˆæ™‚ã¯é¸æŠä¸­ã®ãƒ—ãƒªã‚»ãƒƒãƒˆã‚µã‚¤ã‚ºã‚’é©ç”¨

**å®Œäº†æ¡ä»¶ï¼šãƒ‰ãƒ©ãƒƒã‚°ã§ã‚µã‚¤ã‚ºå¤‰æ›´ã§ãã‚‹ã€ä½œæˆæ™‚ã¯ãƒ—ãƒªã‚»ãƒƒãƒˆãŒé©ç”¨ã•ã‚Œã‚‹**

---

### Phase 6: ä»˜ç®‹ã®è‰²ãƒ»ã‚µã‚¤ã‚ºå¤‰æ›´
**ç›®æ¨™ï¼šä½œæˆå¾Œã®ä»˜ç®‹ã®è‰²ã¨ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã§ãã‚‹**

- [ ] ä»˜ç®‹ã«è‰²å¤‰æ›´UIè¿½åŠ 
  - ã‚¯ãƒªãƒƒã‚¯ã§ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆè¡¨ç¤º
  - è‰²é¸æŠã§å³åæ˜ 
- [ ] ä»˜ç®‹ã«ã‚µã‚¤ã‚ºå¤‰æ›´UIè¿½åŠ 
  - ã‚¯ãƒªãƒƒã‚¯ã§S/M/Lé¸æŠè¡¨ç¤º
  - ã‚µã‚¤ã‚ºé¸æŠã§å³åæ˜ 

**å®Œäº†æ¡ä»¶ï¼šæ—¢å­˜ã®ä»˜ç®‹ã®è‰²ã¨ã‚µã‚¤ã‚ºã‚’UIã‹ã‚‰å¤‰æ›´ã§ãã‚‹**

---

### Phase 7: ä¸€æ‹¬æ“ä½œ
**ç›®æ¨™ï¼šéè¡¨ç¤º/è¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆã¨ä¸€æ‹¬ã‚¯ãƒªã‚¢**

- [ ] ä¸€æ‹¬éè¡¨ç¤º/è¡¨ç¤ºãƒˆã‚°ãƒ«å®Ÿè£…ï¼ˆç›®ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
  - è¡¨ç¤ºçŠ¶æ…‹ã‚’StickyManagerã§ç®¡ç†
  - å…¨ä»˜ç®‹ã®visibilityã‚’åˆ‡ã‚Šæ›¿ãˆ
  - ã‚¢ã‚¤ã‚³ãƒ³ã®è¦‹ãŸç›®ã‚‚åˆ‡ã‚Šæ›¿ãˆï¼ˆğŸ‘ â†” ğŸ‘â€ğŸ—¨ï¼‰
- [ ] ä¸€æ‹¬ã‚¯ãƒªã‚¢å®Ÿè£…ï¼ˆã‚´ãƒŸç®±ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
  - ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
  - å…¨ä»˜ç®‹ã®å‰Šé™¤

**å®Œäº†æ¡ä»¶ï¼šç›®ã‚¢ã‚¤ã‚³ãƒ³ã§å…¨ä»˜ç®‹ã®éè¡¨ç¤º/è¡¨ç¤ºã€ã‚´ãƒŸç®±ã§ç¢ºèªä»˜ãä¸€æ‹¬å‰Šé™¤ãŒã§ãã‚‹**

---

### Phase 7: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
**ç›®æ¨™ï¼šãƒ¡ãƒ¢ä¸€è¦§ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼**

- [ ] ExportHandlerå®Ÿè£…
- [ ] å…¨ä»˜ç®‹ãƒ†ã‚­ã‚¹ãƒˆã®åé›†
- [ ] ãƒ†ã‚­ã‚¹ãƒˆæ•´å½¢ï¼ˆç•ªå·ä»˜ããƒªã‚¹ãƒˆã€è‰²æƒ…å ±ï¼‰
- [ ] Clipboard APIã§ã‚³ãƒ”ãƒ¼
- [ ] ã‚³ãƒ”ãƒ¼å®Œäº†ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤ºï¼ˆãƒˆãƒ¼ã‚¹ãƒˆç­‰ï¼‰

**å®Œäº†æ¡ä»¶ï¼šã‚³ãƒ”ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å…¨ãƒ¡ãƒ¢ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹**

---

### Phase 8: ä»•ä¸Šã’
**ç›®æ¨™ï¼šå“è³ªå‘ä¸Šã¨ãƒªãƒªãƒ¼ã‚¹æº–å‚™**

- [ ] Shadow DOMã§ä»˜ç®‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
- [ ] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆä»˜ç®‹è¿½åŠ ãªã©ï¼‰
- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å¯¾å¿œï¼ˆãƒ†ã‚­ã‚¹ãƒˆæœªå…¥åŠ›ã®ä»˜ç®‹é™¤å¤–ãªã©ï¼‰
- [ ] ã‚¢ã‚¤ã‚³ãƒ³ä½œæˆ
- [ ] READMEã®æ•´å‚™

**å®Œäº†æ¡ä»¶ï¼šChrome Web Storeã«å…¬é–‹ã§ãã‚‹çŠ¶æ…‹**

---

## 5. å®Ÿè£…ä¸Šã®æ³¨æ„ç‚¹

### 5.1 Shadow DOMã®ä½¿ç”¨
ãƒ›ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã®CSSã¨å¹²æ¸‰ã—ãªã„ã‚ˆã†ã€ä»˜ç®‹è¦ç´ ã¯Shadow DOMå†…ã«é…ç½®ã™ã‚‹ã€‚

```typescript
const host = document.createElement('div');
const shadow = host.attachShadow({ mode: 'closed' });
// shadowå†…ã«ä»˜ç®‹ã‚’è¿½åŠ 
```

### 5.2 ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒ†ã‚­ã‚¹ãƒˆé¸æŠé˜²æ­¢
```typescript
document.addEventListener('mousemove', (e) => {
  if (isDragging) {
    e.preventDefault();
  }
});
```

### 5.3 z-indexã®ç®¡ç†
ä»˜ç®‹ã‚¯ãƒªãƒƒã‚¯æ™‚ã«æœ€å‰é¢ã«ç§»å‹•ã•ã›ã‚‹ã€‚

```typescript
let maxZIndex = 10000;
note.style.zIndex = String(++maxZIndex);
```

### 5.4 Content Scriptã¨Popupé–“ã®é€šä¿¡
ãƒ¡ãƒ¢ä¸€è¦§å–å¾—ã«ã¯chrome.runtime.sendMessageã‚’ä½¿ç”¨ã€‚

---

## 6. ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ï¼ˆæ¡ˆï¼‰

```
# Webä»˜ç®‹ãƒ¡ãƒ¢
URL: https://zenn.dev/example/article

1. [é»„] ã“ã“ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³å‚è€ƒã«ãªã‚‹
2. [é’] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ›¸ãæ–¹
3. [ãƒ”ãƒ³ã‚¯] ã‚ã¨ã§è©¦ã™
```

---

## 7. è¦‹ç©ã‚‚ã‚Šï¼ˆç›®å®‰ï¼‰

| ãƒ•ã‚§ãƒ¼ã‚º | æƒ³å®šæ™‚é–“ |
|----------|----------|
| Phase 1 | 1æ™‚é–“ |
| Phase 2 | 2æ™‚é–“ |
| Phase 3 | 2æ™‚é–“ |
| Phase 4 | 1.5æ™‚é–“ |
| Phase 5 | 1.5æ™‚é–“ |
| Phase 6 | 1.5æ™‚é–“ |
| Phase 7 | 1æ™‚é–“ |
| Phase 8 | 1.5æ™‚é–“ |
| Phase 9 | 2æ™‚é–“ |
| Phase 10 | 2æ™‚é–“ |
| **åˆè¨ˆ** | **ç´„16æ™‚é–“** |
